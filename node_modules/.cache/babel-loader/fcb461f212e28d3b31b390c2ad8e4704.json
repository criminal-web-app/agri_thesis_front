{"ast":null,"code":"import _classCallCheck from \"/home/cdi_5/agri_thesis_front/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/cdi_5/agri_thesis_front/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/cdi_5/agri_thesis_front/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/cdi_5/agri_thesis_front/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/cdi_5/agri_thesis_front/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/cdi_5/agri_thesis_front/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/cdi_5/agri_thesis_front/src/components/Orders.js\";\nimport React, { Component } from 'react';\nimport { withRouter, NavLink } from 'react-router-dom';\nimport { Row, Col, Button, Input } from 'reactstrap';\nimport ReactTable from 'react-table';\nimport * as API from '../services/API';\nimport * as Session from '../services/session';\nimport { Helpers, lS, DefaultState, TOAST, OPTIONS, gDp, DATE_FORMAT } from '../helpers/helpers';\nimport SearchBar from './SearchBar.js';\nimport ConfirmModal from '../modals/ConfirmModal';\nimport background from '../pic/photo.jpg';\nimport { FaTrashAlt, FaEdit } from 'react-icons/fa/';\nimport Loader from './Loader';\n\nvar moment = require('moment');\n\nvar qs = require('query-string'); // React table ref: https://react-table.js.org/#/story/readme\n\n\nvar Products =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Products, _Component);\n\n  function Products() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Products);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Products)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.urlSearch = qs.parse(_this.props.history.location.search);\n    _this.state = {\n      data: [],\n      query: _this.urlSearch.search || '',\n      confirmUser: {\n        username: ''\n      },\n      pageState: {\n        page: parseInt(_this.urlSearch.page || 0) > 0 ? parseInt(_this.urlSearch.page || 0) - 1 : 0,\n        limit: parseInt(_this.urlSearch.limit || 10),\n        sort_id: _this.urlSearch.sort_id || 'created',\n        sort_desc: _this.urlSearch.sort_desc || 'desc',\n        search: _this.urlSearch.search || ''\n      },\n      columns: [{\n        Header: \"Name\",\n        headerClassName: 'text-left',\n        accessor: \"last_name\",\n        Cell: function Cell(row) {\n          return Helpers.handleDisplay((row.original.last_name ? row.original.last_name + ', ' : '') + row.original.first_name || '');\n        }\n      }, {\n        Header: \"Date\",\n        headerClassName: 'text-left',\n        sortable: false,\n        accessor: \"created\",\n        Cell: function Cell(row) {\n          return Helpers.handleDate(row.value, DATE_FORMAT);\n        }\n      }, {\n        Header: \"Role\",\n        headerClassName: 'text-left',\n        accessor: \"role\",\n        Cell: function Cell(row) {\n          return Helpers.handleDisplay(row.value);\n        }\n      }]\n    };\n    _this.prevColumn = _this.state.columns || {};\n\n    _this.selectActionToggled = function (item) {\n      _this.setState({\n        itemData: item\n      });\n    };\n\n    _this.responseGetItems = function (response) {\n      var st = _this.state;\n      response = response || {\n        data: []\n      };\n      response.data = response.data || [];\n      var configState = {\n        data: response.data,\n        total: response.count,\n        totalPage: Math.ceil((response.count || 0) / st.pageState.limit) // configState.totalPage = Math.ceil(configState.data.length / st.pageState.limit) \n\n      };\n\n      _this.setState(configState);\n    };\n\n    _this.fetchData = function () {\n      // document.getElementsByClassName('rt-tbody')[0].scrollTop = 0;\n      var that = _assertThisInitialized(_assertThisInitialized(_this));\n\n      var st = _this.state;\n\n      _this.toggleLoading(true);\n\n      var params = {\n        // page: (st.pageState.page+1),\n        // limit: st.pageState.limit,\n        search: st.pageState.search,\n        sort_id: st.pageState.sort_id || '',\n        sort_desc: !st.pageState.sort_id ? '' : (st.pageState.sort_desc || '').toString() === 'true' ? st.pageState.sort_desc : 'desc',\n        is_read: st.filter === 'READ' ? 'true' : st.filter === 'UNREAD' ? 'false' : '',\n        is_completed: st.filter === 'COMPLETE' ? 'true' : st.filter === 'INCOMPLETE' ? 'false' : ''\n      };\n      console.log(params);\n      API.getOrders({\n        params: params\n      }).then(function (response) {\n        _this.responseGetItems(response);\n      }, function (err) {\n        _this.setState({\n          data: []\n        });\n\n        TOAST.pop({\n          message: err.message,\n          type: 'error'\n        });\n      }).finally(function () {\n        _this.setState({\n          searchLoading: false,\n          apiParams: params\n        });\n      });\n    };\n\n    _this.handleSearch = function (e) {\n      var that = _assertThisInitialized(_assertThisInitialized(_this));\n\n      var st = _this.state;\n      e.preventDefault();\n      Helpers.handlePage(that, {\n        page: 0,\n        limit: st.pageState.limit,\n        search: st.query,\n        sort_id: st.pageState.sort_id,\n        sort_desc: !!st.pageState.sort_desc\n      });\n    };\n\n    _this.toggleLoading = function (flag) {\n      _this.setState(function (oldState) {\n        return {\n          searchLoading: flag\n        };\n      });\n    };\n\n    _this.toggleButton = function (path) {\n      _this.props.history.push(path);\n    };\n\n    _this.componentDidMount = function () {\n      Helpers.callBackMessageToastPop();\n\n      _this.setState({\n        searchLoading: true,\n        mounted: true,\n        checkData: [],\n        data: []\n      }, function () {\n        _this.fetchData();\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Products, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(newProps) {\n      var _this2 = this;\n\n      var st = this.state;\n      var filters_array = Helpers.objectToArray(st.pageState.filter, true) || [];\n      this.setState({\n        showAdvancedSearch: filters_array.length > 0\n      });\n\n      if (typeof st.mounted !== 'undefined') {\n        var pageQs = qs.parse(this.props.history.location.search);\n        this.setState({\n          pageState: {\n            page: parseInt(pageQs.page || 0) > 0 ? parseInt(pageQs.page || 0) - 1 : 0,\n            limit: parseInt(pageQs.limit || 10),\n            search: st.query,\n            sort_id: pageQs.sort_id || st.pageState.sort_id,\n            sort_desc: !!pageQs.sort_desc\n          }\n        }, function () {\n          _this2.fetchData();\n        });\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.setState({\n        checkData: [],\n        data: []\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var that = this;\n      var st = this.state;\n      var original = st.selected || {}; // st.data = st.data.map(d=> ({ ...d, check: st.checkData.filter(cData=>d.id===cData.id).length > 0 }))\n      // st.columns = [\n      //     ...this.prevColumn,\n      // ]\n\n      var messages = st.data.map(function (message, index) {\n        return React.createElement(\"div\", {\n          key: index,\n          style: {\n            background: 'white',\n            padding: '10px',\n            border: '2px solid #014401',\n            borderRadius: '5px',\n            marginBottom: '10px',\n            cursor: 'pointer'\n          },\n          onClick: function onClick() {\n            return _this3.props.history.push(\"order/\".concat(message.id));\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: message.is_read ? {\n            marginBottom: '2px'\n          } : {\n            marginBottom: '2px',\n            fontSize: '18px',\n            fontWeight: '700'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163\n          },\n          __self: this\n        }, message.is_read ? '' : React.createElement(\"span\", {\n          style: {\n            fontWeight: '400',\n            fontSize: '14px',\n            color: 'red'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164\n          },\n          __self: this\n        }, \"*\"), message.first_name, \" \", message.last_name, React.createElement(\"span\", {\n          style: {\n            fontSize: '12px',\n            color: 'gray',\n            float: 'right'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166\n          },\n          __self: this\n        }, \" (\", moment(message.created).format('MMM DD YYYY'), \")\")), React.createElement(\"div\", {\n          style: {\n            fontSize: '12px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168\n          },\n          __self: this\n        }, \"(\".concat(gDp(message, 'phone_number', ''), \")\")), React.createElement(\"div\", {\n          style: {\n            borderBottom: '1px solid #014401',\n            fontSize: '12px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169\n          },\n          __self: this\n        }, \"\".concat(gDp(message, 'email', '')), React.createElement(\"span\", {\n          style: {\n            fontSize: '12px',\n            color: 'gray',\n            float: 'right'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, \"Status: \", !message.is_read ? 'Pending' : message.is_completed ? 'Completed' : 'Processing')), React.createElement(\"div\", {\n          style: message.is_read ? {} : {\n            fontSize: '16px',\n            fontWeight: '700'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173\n          },\n          __self: this\n        }, \"- \", message.message));\n      });\n      return React.createElement(\"div\", {\n        style: {\n          margin: '0 5% 15px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"pad-md\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(Col, {\n        className: \"margin-bottom-md\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          marginBottom: '10px',\n          position: 'relative'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        style: {\n          position: 'absolute',\n          bottom: '5px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, \"Filter by:\"), React.createElement(Input, {\n        style: {\n          maxWidth: '150px',\n          marginLeft: '70px',\n          padding: '5px'\n        },\n        type: \"select\",\n        name: \"filter\",\n        value: this.state.filter,\n        onChange: function onChange(e) {\n          return _this3.setState({\n            filter: e.target.value\n          }, function () {\n            return _this3.fetchData();\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, \"All\"), React.createElement(\"option\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, \"UNREAD\"), React.createElement(\"option\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, \"INCOMPLETE\"), React.createElement(\"option\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, \"READ\"), React.createElement(\"option\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, \"COMPLETE\"))), React.createElement(\"hr\", {\n        style: {\n          color: 'rgb(150,150,150,0.5)'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }), messages)), React.createElement(ConfirmModal, {\n        size: \"sm\",\n        takeAction: function takeAction() {\n          return _this3.deleteUser(st.confirmUser);\n        },\n        isOpen: st.isItemModalOpen,\n        isConfirmClick: st.isConfirmClick,\n        error: st.errorDelete,\n        itemData: original,\n        modalTitle: 'Delete User',\n        modalBody: React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 203\n          },\n          __self: this\n        }, \"Are you sure you want to delete user \", React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 203\n          },\n          __self: this\n        }, st.confirmUser.username), \" ?\"),\n        onDeleteItem: this.fetchData,\n        toggle: function toggle() {\n          _this3.changeKeyValue(\"isItemModalOpen\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      })), React.createElement(Loader, {\n        message: React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        }, React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        }, \"Loading...\")),\n        isLoading: st.isLoading || false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Products;\n}(Component);\n\nexport default withRouter(Products);","map":{"version":3,"sources":["/home/cdi_5/agri_thesis_front/src/components/Orders.js"],"names":["React","Component","withRouter","NavLink","Row","Col","Button","Input","ReactTable","API","Session","Helpers","lS","DefaultState","TOAST","OPTIONS","gDp","DATE_FORMAT","SearchBar","ConfirmModal","background","FaTrashAlt","FaEdit","Loader","moment","require","qs","Products","urlSearch","parse","props","history","location","search","state","data","query","confirmUser","username","pageState","page","parseInt","limit","sort_id","sort_desc","columns","Header","headerClassName","accessor","Cell","row","handleDisplay","original","last_name","first_name","sortable","handleDate","value","prevColumn","selectActionToggled","item","setState","itemData","responseGetItems","response","st","configState","total","count","totalPage","Math","ceil","fetchData","that","toggleLoading","params","toString","is_read","filter","is_completed","console","log","getOrders","then","err","pop","message","type","finally","searchLoading","apiParams","handleSearch","e","preventDefault","handlePage","flag","oldState","toggleButton","path","push","componentDidMount","callBackMessageToastPop","mounted","checkData","newProps","filters_array","objectToArray","showAdvancedSearch","length","pageQs","selected","messages","map","index","padding","border","borderRadius","marginBottom","cursor","id","fontSize","fontWeight","color","float","created","format","borderBottom","margin","position","bottom","maxWidth","marginLeft","target","deleteUser","isItemModalOpen","isConfirmClick","errorDelete","changeKeyValue","isLoading"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { withRouter, NavLink } from 'react-router-dom' \nimport { Row, Col, Button, Input } from 'reactstrap'\nimport ReactTable from 'react-table'\n\nimport * as API from '../services/API'\nimport * as Session from '../services/session'\n\nimport { Helpers, lS, DefaultState, TOAST, OPTIONS, gDp, DATE_FORMAT  } from '../helpers/helpers'\n\nimport SearchBar from './SearchBar.js'\nimport ConfirmModal from '../modals/ConfirmModal'\n\nimport background from '../pic/photo.jpg';\nimport {FaTrashAlt, FaEdit} from 'react-icons/fa/'\nimport Loader from './Loader'\nconst moment = require('moment');\n\nconst qs = require('query-string');\n\n// React table ref: https://react-table.js.org/#/story/readme\n\nclass Products extends Component {\n    urlSearch = qs.parse(this.props.history.location.search)\n    state = {\n        data: [],\n        query: this.urlSearch.search || '',\n        confirmUser: {username: ''},\n        pageState: {\n            page: (parseInt(this.urlSearch.page || 0) > 0 ? (parseInt(this.urlSearch.page || 0) - 1 ) : 0),\n            limit: parseInt(this.urlSearch.limit || 10),\n            sort_id: this.urlSearch.sort_id || 'created',\n            sort_desc: this.urlSearch.sort_desc || 'desc',\n            search: this.urlSearch.search || '',\n        },\n        columns: [\n            {\n                Header: \"Name\",\n                headerClassName: 'text-left',\n                accessor: \"last_name\",\n                Cell: row=> Helpers.handleDisplay(((row.original.last_name) ? (row.original.last_name+', ') : '') + row.original.first_name || '')\n            },\n            {\n                Header: \"Date\",\n                headerClassName: 'text-left',\n                sortable: false,\n                accessor: \"created\",\n                Cell: row=> Helpers.handleDate(row.value, DATE_FORMAT)\n            },\n            {\n                Header: \"Role\",\n                headerClassName: 'text-left',\n                accessor: \"role\",\n                Cell: row=> Helpers.handleDisplay(row.value)\n            },\n        ],\n    }\n\n    prevColumn = this.state.columns || {}\n\n    selectActionToggled = (item) => {\n        this.setState({\n            itemData: item\n        })\n    }\n\n    responseGetItems = (response) => { \n        const st = this.state\n        response = response || {data:[]}\n        response.data = response.data || []\n        let configState = {\n            data: response.data,\n            total: response.count,\n            totalPage: Math.ceil( (response.count || 0) / st.pageState.limit) \n        }\n        // configState.totalPage = Math.ceil(configState.data.length / st.pageState.limit) \n        this.setState(configState)\n    }\n\n    fetchData = () => {\n\n        // document.getElementsByClassName('rt-tbody')[0].scrollTop = 0;\n        const that = this;\n        const st = this.state\n        this.toggleLoading(true)\n        const params = { \n            // page: (st.pageState.page+1),\n            // limit: st.pageState.limit,\n            search: st.pageState.search,\n            sort_id: st.pageState.sort_id || '',\n            sort_desc: (!st.pageState.sort_id) ? '' :\n                       (st.pageState.sort_desc || '').toString() === 'true' ? st.pageState.sort_desc : 'desc',\n            is_read: st.filter === 'READ' ? 'true' : st.filter ==='UNREAD' ? 'false' : '',\n            is_completed: st.filter === 'COMPLETE' ? 'true' : st.filter === 'INCOMPLETE' ? 'false': '',\n        }\n        console.log(params)\n        API.getOrders({params})\n            .then(response => { \n                this.responseGetItems(response) \n            }, err=> {\n                this.setState({data:[]});\n                TOAST.pop({message: err.message, type: 'error'})\n            }).finally(()=>{\n                this.setState({ searchLoading: false, apiParams: params })\n            })\n    }\n\n    handleSearch = (e) => {\n        const that = this;\n        const st = this.state\n        e.preventDefault()\n        Helpers.handlePage(that, {page: 0, limit: st.pageState.limit, search: st.query, sort_id: st.pageState.sort_id, sort_desc: !!st.pageState.sort_desc })\n    }\n\n    toggleLoading = (flag) => {\n        this.setState(oldState => ({searchLoading: flag}))\n    }\n    toggleButton = (path) => {\n        this.props.history.push(path)\n    }\n\n    componentDidMount = () => {\n        Helpers.callBackMessageToastPop() \n        this.setState({searchLoading: true, mounted: true, checkData:[], data:[]},()=>{\n            this.fetchData()\n        })\n    }\n\n    componentWillReceiveProps(newProps) {\n        const st = this.state\n        const filters_array = Helpers.objectToArray(st.pageState.filter, true) || []\n        this.setState({showAdvancedSearch: filters_array.length > 0 })\n        if ( typeof st.mounted !== 'undefined') {\n            let pageQs = qs.parse(this.props.history.location.search)\n            this.setState({\n                pageState: {\n                    page: parseInt(pageQs.page || 0) > 0 ? ( parseInt(pageQs.page || 0) - 1): 0,\n                    limit: parseInt(pageQs.limit || 10),\n                    search: st.query,\n                    sort_id: pageQs.sort_id || st.pageState.sort_id,\n                    sort_desc: !!pageQs.sort_desc,\n                } \n            },()=>{\n                this.fetchData();\n            })\n        }\n    } \n\n    componentWillUnmount() {\n        this.setState({checkData: [], data: [] })\n    }\n\n    render() {\n        const that = this\n        const st=this.state;\n        const original = st.selected || {}\n        // st.data = st.data.map(d=> ({ ...d, check: st.checkData.filter(cData=>d.id===cData.id).length > 0 }))\n        // st.columns = [\n        //     ...this.prevColumn,\n        // ]\n        const messages = st.data.map((message, index)=> \n            <div key={index} style={{ background: 'white', padding: '10px', border: '2px solid #014401', borderRadius: '5px', marginBottom: '10px', cursor: 'pointer'}} onClick={()=>this.props.history.push(`order/${message.id}`)}>\n                <div style={message.is_read ? {marginBottom: '2px'} : {marginBottom: '2px', fontSize: '18px', fontWeight: '700'}}>\n                    {message.is_read ? '' : <span style={{fontWeight: '400', fontSize: '14px', color: 'red'}}>*</span>} \n                    {message.first_name} {message.last_name} \n                    {<span style={{fontSize: '12px', color: 'gray', float: 'right'}}> ({moment(message.created).format('MMM DD YYYY')})</span>}\n                </div>\n                <div style={{fontSize: '12px'}}>{`(${gDp(message,'phone_number','')})`}</div>\n                <div style={{borderBottom: '1px solid #014401', fontSize: '12px'}}>\n                    {`${gDp(message,'email','')}`}\n                    {<span style={{fontSize: '12px', color: 'gray', float: 'right'}}>Status: {!message.is_read ? 'Pending' : message.is_completed ? 'Completed' : 'Processing'}</span>}\n                </div>\n                <div style={message.is_read ? {} : {fontSize: '16px', fontWeight: '700'}}>- {message.message}</div>\n            </div>)\n        return (\n            <div style={{margin: '0 5% 15px'}}> \n                <div className=\"pad-md\">\n                    <Row>\n                        <Col className=\"margin-bottom-md\">\n                            <div style={{marginBottom: '10px', position: 'relative'}}>\n                                <span style={{position: 'absolute', bottom: '5px'}}>Filter by:</span> \n                                <Input style={{maxWidth: '150px', marginLeft: '70px', padding: '5px'}} type=\"select\" name=\"filter\" value={this.state.filter} onChange={(e)=>this.setState({filter: e.target.value},()=> this.fetchData())}>\n                                    <option>All</option>\n                                    <option>UNREAD</option>\n                                    <option>INCOMPLETE</option>\n                                    <option>READ</option>\n                                    <option>COMPLETE</option>\n                                </Input>\n                            </div>\n                            <hr style={{color: 'rgb(150,150,150,0.5)'}}/>\n                            {messages}\n                        </Col>\n                    </Row>\n                    <ConfirmModal\n                        size=\"sm\"\n                        takeAction={()=>this.deleteUser(st.confirmUser)}\n                        isOpen={st.isItemModalOpen}\n                        isConfirmClick={st.isConfirmClick}\n                        error={st.errorDelete}\n                        itemData={original}\n                        modalTitle={'Delete User'}\n                        modalBody={ \n                            <p>Are you sure you want to delete user <strong>{st.confirmUser.username}</strong> ?</p>\n                        }\n                        onDeleteItem={this.fetchData}\n                        toggle={\n                            () => {\n                                this.changeKeyValue(\"isItemModalOpen\")\n                            }\n                        }\n                    />\n                </div>\n                <Loader\n                    message={(\n                        <div>\n                            {/* <h4>Fetching reports</h4> */}\n                            <p>Loading...</p>\n                        </div>\n                    )}\n                    isLoading={st.isLoading || false}\n                />\n            </div>\n        ) ;\n    }\n}\n\nexport default withRouter(Products);"]},"metadata":{},"sourceType":"module"}